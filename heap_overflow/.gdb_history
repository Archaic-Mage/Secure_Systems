vmmap
q
b main
r
vis
c
fini
fini
fini
fini
vis
fastbins
tcache
q
b main
r
p sysetm
p system
x/32x 0x7ffff7c50d60
vmmap
q
set environment LD_PRELOAD ./libc.so.6
b main
r
set environment LD_PRELOAD /home/mage/Documents/Semester_6/cs6570/assignments/heap_overflow/libc.so.6
r
start
set exec-wrapper env 'LD_PRELOAD=libc.so.6'
r
q
p &users
b main
r
x/16gx 0x6bd3a0
q
b main
p &users
q
p system
p system
p exit
p printf
p free
exit()
q
c
q
c
fini
ni
si
ni
ni
q
c
q
c
q
c
fini
ni
r
q
c
q
c
fini
ni
si
ni
q
b adduser 
b removeuser 
c
fini
ni
c
c
c
c
c
c
c
q
c
q
b removeuser 
b adduser 
c
c
x/16gx &users
x/22gx &users
x/32gx 0x0000000001a44f70
heap bins fast
x/32gx 0x0000000001a44fa0
ni
fini
ni
x/22x &users
x/32x 0x0000000001a44f80
ni
fini
ni
x/32x 0x0000000001a44f80
x/32gx 0x0000000001a431d0
q
b removeuser 
b adduser 
c
c
fini
ni
x/22gx &users
x/32gx 0x00000000025a8f80
c
x/22gx &users
c
c
x/22gx &users
fini
ni
x/22gx &users
x/32gx 0x00000000025a8f80
vmmap
info proc map
q
b adduser 
b removeuser 
c
x/22gx &users
x/64gx 0x00000000025b1fa0
x/64gx 0x00000000025b1f60
fini
c
c
x/22gx &users
c
x/22gx &users
x/64gx 0x00000000025b1f60
q
vmmap
b main
r
vmmap
p system
p exit
arena
ls
q
b adduser 
b removeuser 
c
x/22gx &users
x/32gx 0x0000000002301f60
q
b adduser 
b removeuser 
c
x/22gx &users
x/32gx 0x0000000001a62f60
fini
ni
x/32gx 0x0000000001a62f60
ni
ni
x/32gx 0x0000000001a62f60
ni
fini
ni
ni
fini
ni
x/32gx 0x0000000001a62f60
x/22gx &users
ni
fini
ni
x/22gx &users
x/32gx 0x0000000001a62f60
q
b adduser 
b removeuser
c
fini
ni
x/22gx &users
x/32gx 0x00000000024ecf60
q
b adduser
b removeuser
c
x/22gx &users
x/32gx 0x0000000001235f60
fini
disassemble free
disassemble 0x420f44
q
b removeuser 
c
fini
ni
x/32x &users
x/22gx &users
x/64gx 0x0000000000c09f60
x/128gx 0x0000000000c09f60
ni
fini
x/64gx 0x0000000000c09f60
x/32x 0x00000000006ba8e0
p main_arena
p &main_arena
vmmap
c
fini
ni
x/22gx &users
x/32gx 0x0000000000c09f90
q
b main
r
p &main_arena
p &users
q
heap bins
q
disassemble free
p main_arena
p &main_arena
p system
p exit
heap
heap bin
heap bins
info variables
p __free_hook
p &__free_hook
q
b main
r
vmmap
p main_arena
q
b main
r
p main_arena
p &main_arena 
p exit
p &__free_hook
vmmap
p &main_arena+96
p &(main_arena+96)
q
vmmap
p main_arena
p &main_arena
q
